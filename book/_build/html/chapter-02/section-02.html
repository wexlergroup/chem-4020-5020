
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>2.2. Canonical Ensemble &#8212; Physical Chemistry II</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css?v=b4b7a797" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/myfile.css?v=536cf54f" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapter-02/section-02';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="2.3. Ensemble Averages" href="section-03.html" />
    <link rel="prev" title="2.1. Introduction to Statistical Mechanics" href="section-01.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Physical Chemistry II - Home"/>
    <img src="../_static/logo.png" class="logo__image only-dark pst-js-only" alt="Physical Chemistry II - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to Physical Chemistry II
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Module 1. Equations of State</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapter-01/section-01.html">1.1. Course Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter-01/section-02.html">1.2. Kinetic Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter-01/section-03.html">1.3. Ideal Gases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter-01/section-04.html">1.4. Real Gases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter-01/review.html">Review</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Module 2. Statistical Mechanics</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="section-01.html">2.1. Introduction to Statistical Mechanics</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">2.2. Canonical Ensemble</a></li>
<li class="toctree-l1"><a class="reference internal" href="section-03.html">2.3. Ensemble Averages</a></li>
<li class="toctree-l1"><a class="reference internal" href="section-04.html">2.4. Molecular Partition Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="section-05.html">2.5. Particle in a Box</a></li>
<li class="toctree-l1"><a class="reference internal" href="section-06.html">2.6. Harmonic Oscillator</a></li>
<li class="toctree-l1"><a class="reference internal" href="section-07.html">2.7. Linear Rigid Rotor</a></li>
<li class="toctree-l1"><a class="reference internal" href="section-08.html">2.8. Molecular Statistical Mechanics</a></li>
<li class="toctree-l1"><a class="reference internal" href="review.html">Review</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Module 3. First Law &amp; Enthalpy</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapter-03/section-01.html">3.1. Conservation of Energy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter-03/section-02.html">3.2. Applications of the First Law</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter-03/section-03.html">3.3. Enthalpy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter-03/review.html">Review</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Module 4. Second Law &amp; Entropy</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapter-04/section-01.html">4.1. Entropy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter-04/section-02.html">4.2. Carnot Cycle</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter-04/section-03.html">4.3. Second Law</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter-04/review.html">Review</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Module 5. Third Law &amp; Free Energy</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapter-05/section-01.html">5.1. Free Energy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter-05/section-02.html">5.2. Third Law</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter-05/section-03.html">5.3. Ammonia Formation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter-05/review.html">Review</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Module 6. Phase Equilibria</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapter-06/section-01.html">6.1. Phase Diagrams</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter-06/review.html">Review</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Module 7. Chemical Equilibrium</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapter-07/review.html">Review</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendices</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../appendices/appendix-a.html">Appendix A. Differential Calculus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendices/appendix-b.html">Appendix B. Thermal Energy</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fchapter-02/section-02.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/chapter-02/section-02.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>2.2. Canonical Ensemble</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#probability-of-a-microstate-in-the-canonical-ensemble">Probability of a Microstate in the Canonical Ensemble</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ratio-of-numbers-of-systems-in-two-microstates-is-a-function-of-their-relative-energies">Ratio of Numbers of Systems in Two Microstates is a Function of Their Relative Energies</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#finding-an-acceptable-form-for-f">Finding an Acceptable Form for <span class="math notranslate nohighlight">\(f\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#converting-f-to-a-probability">Converting <span class="math notranslate nohighlight">\(f\)</span> to a Probability</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#two-state-system">Two-State System</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#partition-function-for-a-two-state-system">Partition Function for a Two-State System</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#probability-of-finding-the-system-in-state-1">Probability of Finding the System in State 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#probability-of-finding-the-system-in-state-2">Probability of Finding the System in State 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#partition-function-as-the-effective-number-of-thermally-accessible-microstates">Partition Function as the Effective Number of Thermally Accessible Microstates</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#computational-studio-two-level-system">Computational Studio: Two-Level System</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="canonical-ensemble">
<h1>2.2. Canonical Ensemble<a class="headerlink" href="#canonical-ensemble" title="Link to this heading">#</a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">#</a></h2>
<p>In a <strong>closed system</strong>—one that exchanges energy but not matter with its surroundings—the appropriate statistical description is the <strong>canonical ensemble</strong>.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.patches</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mpatches</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">myst_nb</span><span class="w"> </span><span class="kn">import</span> <span class="n">glue</span>

<span class="c1"># Helper function to plot a system</span>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_system</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">annotations</span><span class="p">,</span> <span class="n">boundary_color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">):</span>
    <span class="n">box</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">FancyBboxPatch</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;roundtooth&#39;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="n">boundary_color</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">box</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.65</span><span class="p">,</span> <span class="s1">&#39;Surroundings&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">,</span> <span class="s1">&#39;Boundary&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">boundary_color</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">annotation</span> <span class="ow">in</span> <span class="n">annotations</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;arrowprops&quot;</span> <span class="ow">in</span> <span class="n">annotation</span><span class="p">:</span>  <span class="c1"># Arrow annotations</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">annotation</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># Text annotations</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">**</span><span class="n">annotation</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="c1"># Define annotations for each system</span>
<span class="n">annotations</span> <span class="o">=</span> <span class="p">[</span>
        <span class="nb">dict</span><span class="p">(</span><span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">),</span> <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;&lt;-&gt;&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)),</span>
        <span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="s1">&#39;Energy&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">),</span>
<span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plot_system</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">annotations</span><span class="p">)</span>

<span class="n">glue</span><span class="p">(</span><span class="s1">&#39;closed-system&#39;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<figure class="align-center" id="closed-system" style="width: 100%">
<img alt="../_images/c1023ea376e56e820751f0b23818fdd935f10dad1bb3ffed451b5bef03d0278a.png" src="../_images/c1023ea376e56e820751f0b23818fdd935f10dad1bb3ffed451b5bef03d0278a.png" />
<figcaption>
<p><span class="caption-number">Fig. 13 </span><span class="caption-text">A closed system, exchanging energy but not matter with its surroundings.</span><a class="headerlink" href="#closed-system" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="probability-of-a-microstate-in-the-canonical-ensemble">
<h2>Probability of a Microstate in the Canonical Ensemble<a class="headerlink" href="#probability-of-a-microstate-in-the-canonical-ensemble" title="Link to this heading">#</a></h2>
<p>Consider an ensemble of <span class="math notranslate nohighlight">\(\mathcal{A}\)</span> closed systems exchanging energy with a heat bath at temperature <span class="math notranslate nohighlight">\(T\)</span>. A heat bath is an environment that can absorb or release energy without changing its temperature because it is much larger than the system.</p>
<div class="dropdown admonition">
<p class="admonition-title">How Can an Environment Absorb or Release Energy Without Changing Its Temperature?</p>
<p>The key point is that the temperature of a collection of particles is determined by the average kinetic energy per particle. According to the equipartition theorem, for particles with three translational degrees of freedom the total kinetic energy is</p>
<div class="math notranslate nohighlight">
\[E_{\text{kin}} = \frac{3}{2} N\, k_\text{B}\, T.\]</div>
<p>Thus, for a fixed amount of energy transfer, the corresponding change in temperature is given by</p>
<div class="math notranslate nohighlight">
\[\Delta T = \frac{2}{3}\frac{\Delta E_\text{kin}}{N\, k_\text{B}}.\]</div>
<p>Because the environment has many more particles than the system (<span class="math notranslate nohighlight">\(N_\text{env} \gg N_\text{sys}\)</span>), the same amount of energy <span class="math notranslate nohighlight">\(\Delta E\)</span> will result in a much smaller <span class="math notranslate nohighlight">\(\Delta T\)</span> for the environment. In our example, even though the system (with <span class="math notranslate nohighlight">\(N_\text{sys} = 6.022\times10^{23}\)</span> particles) absorbs energy and its temperature increases from 300 K to 400 K, the environment (with <span class="math notranslate nohighlight">\(N_\text{env} = 6.022\times10^{24}\)</span> particles, i.e. 10 times as many) loses the same amount of energy per mole but its temperature only drops from 400 K to 390 K.</p>
<p>This illustrates that an environment (or heat bath) can absorb or release energy almost isothermally because its very large number of particles (and hence its high heat capacity) means that the fractional change in average kinetic energy per particle is negligible—even though energy is being exchanged.</p>
<p>Thus, even though the total kinetic energy of the universe (system plus environment) remains constant, the environment’s temperature barely changes because any energy loss or gain is diluted among a huge number of particles.</p>
</div>
<section id="ratio-of-numbers-of-systems-in-two-microstates-is-a-function-of-their-relative-energies">
<h3>Ratio of Numbers of Systems in Two Microstates is a Function of Their Relative Energies<a class="headerlink" href="#ratio-of-numbers-of-systems-in-two-microstates-is-a-function-of-their-relative-energies" title="Link to this heading">#</a></h3>
<p>Intuition tells us that a system is more likely to be found in microstates with lower energy.</p>
<div class="dropdown admonition">
<p class="admonition-title">Building This Intuition</p>
<p>Consider a raindrop that can exist at two different elevations: one high up at Lake Itasca in northern Minnesota and one low down in the Mississippi River in St. Louis. At the higher elevation, the raindrop has more gravitational potential energy, making that state less favorable. Consequently, the raindrop is more likely to be found at the lower elevation, where its gravitational potential energy is reduced. In essence, systems tend to “prefer” lower energy states, which is why, on a macroscopic scale, water naturally flows downhill.</p>
</div>
<p>Mathematically, this intuition asserts that the ratio of the numbers <span class="math notranslate nohighlight">\(a_1\)</span> and <span class="math notranslate nohighlight">\(a_2\)</span> of systems in two microstates 1 and 2 is given by</p>
<div class="math notranslate nohighlight">
\[\frac{a_2}{a_1} = f \left( E_1, E_2 \right) = f \left( E_1 - E_2 \right),\]</div>
<p>where <span class="math notranslate nohighlight">\(E_1\)</span> and <span class="math notranslate nohighlight">\(E_2\)</span> are the energies of the two microstates. The function <span class="math notranslate nohighlight">\(f\)</span> depends only on the difference in energy between the two states.</p>
<div class="dropdown admonition">
<p class="admonition-title">Why Does the Ratio Depend Only on the Energy Difference?</p>
<p>The energy of a system is defined relative to an arbitrary (but often convenient) reference level. For example,</p>
<ul class="simple">
<li><p>The kinetic energy of a moving particle is defined relative to a stationary particle.</p></li>
<li><p>The gravitational potential energy of a raindrop is defined relative to the surface of the Earth.</p></li>
</ul>
<p>Therefore, the absolute energy of a system is not essential in determining the likelihood of finding the system in a particular microstate, only the difference in energy between two microstates.</p>
</div>
</section>
<section id="finding-an-acceptable-form-for-f">
<h3>Finding an Acceptable Form for <span class="math notranslate nohighlight">\(f\)</span><a class="headerlink" href="#finding-an-acceptable-form-for-f" title="Link to this heading">#</a></h3>
<p>Since <span class="math notranslate nohighlight">\(\{ a_1, a_2, a_3, \ldots \}\)</span> is a set of numbers, we can write</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
\frac{a_3}{a_1} &amp;= \frac{a_2}{a_1} \times \frac{a_3}{a_2} \\
f \left( E_1 - E_3 \right) &amp;= f \left( E_1 - E_2 \right) \times f \left( E_2 - E_3 \right).
\end{align*}\end{split}\]</div>
<p>If <span class="math notranslate nohighlight">\(f\)</span> is “well-behaved” (i.e., continuous, measurable, etc.), it must be of the form</p>
<div class="math notranslate nohighlight">
\[f \left( E_m - E_n \right) = e^{\beta \left( E_m - E_n \right)},\]</div>
<p>where <span class="math notranslate nohighlight">\(\beta\)</span> is an undetermined constant, which we will determine later to be <span class="math notranslate nohighlight">\(\frac{1}{k_\text{B} T}\)</span>.</p>
<div class="dropdown admonition">
<p class="admonition-title">Checking the Form of <span class="math notranslate nohighlight">\(f\)</span></p>
<p>Using this form for <span class="math notranslate nohighlight">\(f\)</span>, we can verify that</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
f \left( E_1 - E_3 \right) &amp;= f \left( E_1 - E_2 \right) \times f \left( E_2 - E_3 \right) \\
e^{\beta \left( E_1 - E_3 \right)} &amp;= e^{\beta \left( E_1 - E_2 \right)} \times e^{\beta \left( E_2 - E_3 \right)} \\
{\color{blue} \cancel{e^{\beta E_1}}} \times {\color{magenta} \cancel{e^{-\beta E_3}}} &amp;= {\color{blue} \cancel{e^{\beta E_1}}} \times {\color{red} \cancel{e^{-\beta E_2}}} \times {\color{red} \cancel{e^{-\beta E_2}}} {\color{magenta} \cancel{e^{-\beta E_3}}} \\
1 &amp;= 1.
\end{align*}\end{split}\]</div>
</div>
</section>
<section id="converting-f-to-a-probability">
<h3>Converting <span class="math notranslate nohighlight">\(f\)</span> to a Probability<a class="headerlink" href="#converting-f-to-a-probability" title="Link to this heading">#</a></h3>
<p>Separating the variables with indices <span class="math notranslate nohighlight">\(m\)</span> and <span class="math notranslate nohighlight">\(n\)</span>,</p>
<div class="math notranslate nohighlight">
\[a_m e^{\beta E_m} = a_n e^{\beta E_n} = \mathcal{C},\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathcal{C}\)</span> is a constant. Therefore, the number of systems in a microstate with energy <span class="math notranslate nohighlight">\(E_m\)</span> is</p>
<div class="math notranslate nohighlight">
\[a_m = \mathcal{C} e^{-\beta E_m}.\]</div>
<p>The constant <span class="math notranslate nohighlight">\(\mathcal{C}\)</span> is determined by the normalization condition</p>
<div class="math notranslate nohighlight">
\[\sum_m a_m = \mathcal{A} = \mathcal{C} \sum_m e^{-\beta E_m},\]</div>
<p>Solving the second equation for <span class="math notranslate nohighlight">\(\mathcal{C}\)</span> and substituting it into the equation for <span class="math notranslate nohighlight">\(a_m\)</span> gives</p>
<div class="math notranslate nohighlight" id="equation-canonical-ensemble-probability">
<span class="eqno">(13)<a class="headerlink" href="#equation-canonical-ensemble-probability" title="Link to this equation">#</a></span>\[p_m = \frac{a_m}{\mathcal{A}} = \frac{e^{-\beta E_m}}{\sum_m e^{-\beta E_m}} = \frac{e^{-\beta E_m}}{Q},\]</div>
<p>where <span class="math notranslate nohighlight">\(p_m\)</span> is the probability of finding the system in microstate <span class="math notranslate nohighlight">\(m\)</span> and <span class="math notranslate nohighlight">\(Q\)</span> is called the <strong>partition function</strong>, which is the essential quantity in statistical mechanics.</p>
</section>
</section>
<section id="two-state-system">
<h2>Two-State System<a class="headerlink" href="#two-state-system" title="Link to this heading">#</a></h2>
<p>Consider a system with two states: state 1 with energy <span class="math notranslate nohighlight">\(E_1\)</span> and state 2 with energy <span class="math notranslate nohighlight">\(E_2\)</span>.</p>
<div class="pst-scrollable-table-container"><table class="table" id="two-level-systems">
<caption><span class="caption-number">Table 7 </span><span class="caption-text">Chemical Contexts Where a Two-State Approximation Might be Appropriate</span><a class="headerlink" href="#two-level-systems" title="Link to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Chemical Context</p></th>
<th class="head"><p>State 1</p></th>
<th class="head"><p>State 2</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Electronic transitions in atoms or molecules</p></td>
<td><p>Ground state</p></td>
<td><p>Excited state</p></td>
</tr>
<tr class="row-odd"><td><p>Donor–acceptor electron transfer</p></td>
<td><p>Reduced state</p></td>
<td><p>Oxidized state</p></td>
</tr>
<tr class="row-even"><td><p>Molecular isomerization</p></td>
<td><p>Reactant</p></td>
<td><p>Product</p></td>
</tr>
<tr class="row-odd"><td><p>Defects in solids</p></td>
<td><p>Defect-free</p></td>
<td><p>Defective</p></td>
</tr>
<tr class="row-even"><td><p>Protein folding</p></td>
<td><p>Unfolded</p></td>
<td><p>Folded</p></td>
</tr>
</tbody>
</table>
</div>
<section id="partition-function-for-a-two-state-system">
<h3>Partition Function for a Two-State System<a class="headerlink" href="#partition-function-for-a-two-state-system" title="Link to this heading">#</a></h3>
<p>The partition function <span class="math notranslate nohighlight">\(Q_\text{two-state}\)</span> for a two-state system is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
Q_\text{two-state} &amp;= e^{-\beta E_1} + e^{-\beta E_2} \\
&amp;= e^{-\beta E_1} \left( 1 + e^{-\beta \Delta E} \right),
\end{align*}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\Delta E = E_2 - E_1\)</span> is the energy difference between the two states.</p>
</section>
<section id="probability-of-finding-the-system-in-state-1">
<h3>Probability of Finding the System in State 1<a class="headerlink" href="#probability-of-finding-the-system-in-state-1" title="Link to this heading">#</a></h3>
<p>The probability of finding the system in state 1 is</p>
<div class="math notranslate nohighlight">
\[p_1 = \frac{e^{-\beta E_1}}{Q_\text{two-state}} = \frac{1}{1 + e^{-\beta \Delta E}} = \frac{1}{1 + e^{-\frac{\Delta E}{k_\text{B} T}}}.\]</div>
</section>
<section id="probability-of-finding-the-system-in-state-2">
<h3>Probability of Finding the System in State 2<a class="headerlink" href="#probability-of-finding-the-system-in-state-2" title="Link to this heading">#</a></h3>
<p>The probability of finding the system in state 2 is</p>
<div class="math notranslate nohighlight">
\[p_2 = 1 - p_1\]</div>
</section>
<section id="partition-function-as-the-effective-number-of-thermally-accessible-microstates">
<h3>Partition Function as the Effective Number of Thermally Accessible Microstates<a class="headerlink" href="#partition-function-as-the-effective-number-of-thermally-accessible-microstates" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.constants</span><span class="w"> </span><span class="kn">import</span> <span class="n">k</span><span class="p">,</span> <span class="n">eV</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">labellines</span><span class="w"> </span><span class="kn">import</span> <span class="n">labelLines</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">myst_nb</span><span class="w"> </span><span class="kn">import</span> <span class="n">glue</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.patches</span><span class="w"> </span><span class="kn">import</span> <span class="n">Rectangle</span>

<span class="n">k_B</span> <span class="o">=</span> <span class="n">k</span> <span class="o">/</span> <span class="n">eV</span>  <span class="c1"># Boltzmann constant in eV/K</span>

<span class="c1"># Define the partition function for a two-state system</span>
<span class="k">def</span><span class="w"> </span><span class="nf">partition_function_two_state</span><span class="p">(</span><span class="n">E1</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">k_B</span> <span class="o">*</span> <span class="n">T</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">beta</span> <span class="o">*</span> <span class="n">E1</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">beta</span> <span class="o">*</span> <span class="n">E2</span><span class="p">)</span>

<span class="c1"># Calculate the partition function for a two-state system</span>
<span class="n">E1</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">E2</span> <span class="o">=</span> <span class="mf">0.01</span>  <span class="c1"># Energy difference between the two states in eV</span>
<span class="n">T_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">Q_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">partition_function_two_state</span><span class="p">(</span><span class="n">E1</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span> <span class="k">for</span> <span class="n">T</span> <span class="ow">in</span> <span class="n">T_values</span><span class="p">]</span>

<span class="c1"># Calculate the probabilities of finding the system in each state for a two-state system</span>
<span class="n">p1_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">k_B</span> <span class="o">*</span> <span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="n">E1</span><span class="p">)</span> <span class="o">/</span> <span class="n">Q</span> <span class="k">for</span> <span class="n">T</span><span class="p">,</span> <span class="n">Q</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">T_values</span><span class="p">,</span> <span class="n">Q_values</span><span class="p">)]</span>
<span class="n">p2_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">k_B</span> <span class="o">*</span> <span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="n">E2</span><span class="p">)</span> <span class="o">/</span> <span class="n">Q</span> <span class="k">for</span> <span class="n">T</span><span class="p">,</span> <span class="n">Q</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">T_values</span><span class="p">,</span> <span class="n">Q_values</span><span class="p">)]</span>

<span class="c1"># Plot the partition function and the probabilities of finding the system in each state</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="c1"># Plot the partition function on axs[0]</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">T_values</span><span class="p">,</span> <span class="n">Q_values</span><span class="p">,</span> <span class="s1">&#39;k-&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Temperature (K)&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$Q_{</span><span class="se">\\</span><span class="s1">text{two-state}}$&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">rightarrow 1$ accessible</span><span class="se">\n</span><span class="s1">microstate&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="n">Q_values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.01</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">),</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">),</span>
    <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round,pad=0.3&#39;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">),</span>
    <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span>
<span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">rightarrow 2$ accessible</span><span class="se">\n</span><span class="s1">microstates&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">T_values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">Q_values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">750</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">),</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">),</span>
    <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round,pad=0.3&#39;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">),</span>
    <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;m&#39;</span>
<span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Plot the probabilities of finding the system in each state on axs[1]</span>
<span class="n">p1_line</span><span class="p">,</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">T_values</span><span class="p">,</span> <span class="n">p1_values</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;State 1&#39;</span><span class="p">)</span>
<span class="n">p2_line</span><span class="p">,</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">T_values</span><span class="p">,</span> <span class="n">p2_values</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;State 2&#39;</span><span class="p">)</span>
<span class="n">labelLines</span><span class="p">([</span><span class="n">p1_line</span><span class="p">,</span> <span class="n">p2_line</span><span class="p">],</span> <span class="n">zorder</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Temperature (K)&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Probability&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># ensure y-axis spans from 0 to 1</span>

<span class="c1"># Add tall outlined rectangles around the probabilities at low and high temperatures.</span>
<span class="c1"># For T -&gt; 0: highlight T from 1 to 50 K.</span>
<span class="c1"># For T = 1000: highlight T from 950 to 1000 K.</span>
<span class="n">rect_low</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">50</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">rect_high</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">((</span><span class="mi">950</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">1000</span> <span class="o">-</span> <span class="mi">950</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">rect_low</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">rect_high</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="s1">&#39;Only state 1 is accessed&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">),</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">),</span>
    <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span>
<span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="s1">&#39;Both states are accessed&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">950</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">900</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">),</span>
    <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;m&#39;</span>
<span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">glue</span><span class="p">(</span><span class="s1">&#39;two-state-system&#39;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<figure class="align-center" id="id1" style="width: 100%">
<img alt="../_images/1cb5dbb14bb2d63e860d0aa471f68ff97184bc7c8ea02c47f8e6497410268298.png" src="../_images/1cb5dbb14bb2d63e860d0aa471f68ff97184bc7c8ea02c47f8e6497410268298.png" />
<figcaption>
<p><span class="caption-number">Fig. 14 </span><span class="caption-text">Partition function of a two-state system and the probabilities of finding it in each state as a function of temperature. The energy difference between the two states is 0.01 eV.</span><a class="headerlink" href="#id1" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
</section>
<section id="computational-studio-two-level-system">
<h2>Computational Studio: Two-Level System<a class="headerlink" href="#computational-studio-two-level-system" title="Link to this heading">#</a></h2>
<p>Explore how the canonical probabilities, partition function, and heat capacity respond to changes in the energy gap and temperature range.</p>
<div style="width: 100%; border: 1px solid #cbd5e1; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.08);">
  <iframe
    src="../computational-studios/two-level-system.html"
    title="Two-Level System Studio"
    style="width: 100%; height: 850px; border: 0;"
    loading="lazy"
  ></iframe>
</div><p>If the embed does not load, you can open the studio in a new tab: <a class="reference download internal" download="" href="../_downloads/0d670f51597b76befe4170e7374a1c70/two-level-system.html"><span class="xref download myst">Two-Level System Studio</span></a>.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapter-02"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="section-01.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">2.1. Introduction to Statistical Mechanics</p>
      </div>
    </a>
    <a class="right-next"
       href="section-03.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">2.3. Ensemble Averages</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#probability-of-a-microstate-in-the-canonical-ensemble">Probability of a Microstate in the Canonical Ensemble</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ratio-of-numbers-of-systems-in-two-microstates-is-a-function-of-their-relative-energies">Ratio of Numbers of Systems in Two Microstates is a Function of Their Relative Energies</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#finding-an-acceptable-form-for-f">Finding an Acceptable Form for <span class="math notranslate nohighlight">\(f\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#converting-f-to-a-probability">Converting <span class="math notranslate nohighlight">\(f\)</span> to a Probability</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#two-state-system">Two-State System</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#partition-function-for-a-two-state-system">Partition Function for a Two-State System</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#probability-of-finding-the-system-in-state-1">Probability of Finding the System in State 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#probability-of-finding-the-system-in-state-2">Probability of Finding the System in State 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#partition-function-as-the-effective-number-of-thermally-accessible-microstates">Partition Function as the Effective Number of Thermally Accessible Microstates</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#computational-studio-two-level-system">Computational Studio: Two-Level System</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Robert B. Wexler
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>