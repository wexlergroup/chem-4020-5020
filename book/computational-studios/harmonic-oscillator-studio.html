<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Harmonic Oscillator Computational Studio</title>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600&family=IBM+Plex+Mono:wght@400;600&display=swap");

      :root {
        color-scheme: light;
        --ink: #0f172a;
        --muted: #4b5563;
        --soft: #94a3b8;
        --card: #ffffff;
        --border: #dbe2ea;
        --accent: #0ea5a0;
        --accent-dark: #0f766e;
        --accent-warm: #f97316;
        --shadow: 0 16px 36px rgba(15, 23, 42, 0.12);
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        font-family: "Space Grotesk", "Segoe UI", sans-serif;
        color: var(--ink);
        background:
          radial-gradient(800px 400px at 2% 0%, #e0f2fe 0%, transparent 60%),
          radial-gradient(900px 520px at 98% 12%, #fef3c7 0%, transparent 55%),
          linear-gradient(180deg, #f8fafc 0%, #edf2f7 65%, #f8fafc 100%);
        min-height: 100vh;
      }

      .page {
        max-width: 1200px;
        margin: 0 auto;
        padding: 24px 18px 40px;
      }

      .hero {
        background: var(--card);
        border: 1px solid var(--border);
        border-radius: 24px;
        padding: 26px 28px;
        box-shadow: var(--shadow);
        position: relative;
        overflow: hidden;
        animation: rise 0.45s ease both;
      }

      .hero::after {
        content: "";
        position: absolute;
        inset: 0;
        background: linear-gradient(120deg, rgba(14, 165, 160, 0.08), transparent 60%);
        pointer-events: none;
      }

      .eyebrow {
        font-size: 0.7rem;
        text-transform: uppercase;
        letter-spacing: 0.22em;
        color: var(--accent-dark);
        font-weight: 600;
      }

      .hero h1 {
        margin: 10px 0 8px;
        font-size: clamp(2rem, 3vw, 2.6rem);
      }

      .hero p {
        margin: 0;
        color: var(--muted);
        max-width: 760px;
        line-height: 1.6;
      }

      .meta-grid {
        margin-top: 18px;
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 12px;
      }

      .meta-card {
        background: #f8fafc;
        border: 1px solid #e2e8f0;
        border-radius: 14px;
        padding: 12px 14px;
      }

      .meta-label {
        font-size: 0.7rem;
        text-transform: uppercase;
        letter-spacing: 0.15em;
        color: var(--soft);
      }

      .meta-value {
        display: block;
        margin-top: 6px;
        font-family: "IBM Plex Mono", ui-monospace, monospace;
        font-size: 0.95rem;
      }

      .layout {
        display: grid;
        grid-template-columns: minmax(260px, 320px) 1fr;
        gap: 20px;
        margin-top: 22px;
      }

      .card {
        background: var(--card);
        border: 1px solid var(--border);
        border-radius: 20px;
        padding: 20px;
        box-shadow: var(--shadow);
        animation: rise 0.5s ease both;
      }

      .panel h2 {
        margin: 0 0 18px;
        font-size: 1.05rem;
      }

      .control {
        margin-bottom: 18px;
      }

      .control label {
        display: block;
        margin-bottom: 8px;
        font-weight: 600;
      }

      .range-row {
        display: grid;
        grid-template-columns: 1fr auto;
        align-items: center;
        gap: 10px;
      }

      input[type="range"] {
        width: 100%;
        accent-color: var(--accent);
      }

      .pill {
        background: #ecfeff;
        border: 1px solid #a5f3fc;
        color: #0e7490;
        font-family: "IBM Plex Mono", ui-monospace, monospace;
        font-size: 0.82rem;
        border-radius: 999px;
        padding: 4px 10px;
      }

      .helper {
        margin-top: 6px;
        font-size: 0.8rem;
        color: var(--muted);
      }

      .toggle-row {
        display: flex;
        align-items: center;
        justify-content: space-between;
        background: #f8fafc;
        border: 1px solid #e2e8f0;
        border-radius: 12px;
        padding: 10px 12px;
        font-size: 0.85rem;
      }

      .toggle {
        width: 46px;
        height: 24px;
        border-radius: 999px;
        border: none;
        cursor: pointer;
        position: relative;
        background: #cbd5f5;
        transition: background 0.2s ease;
      }

      .toggle::after {
        content: "";
        position: absolute;
        width: 18px;
        height: 18px;
        border-radius: 50%;
        background: white;
        top: 3px;
        left: 4px;
        transition: transform 0.2s ease;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.18);
      }

      .toggle.active {
        background: var(--accent);
      }

      .toggle.active::after {
        transform: translateX(20px);
      }

      .section-title {
        margin: 18px 0 12px;
        font-size: 0.85rem;
        text-transform: uppercase;
        letter-spacing: 0.18em;
        color: var(--accent-dark);
      }

      .formula {
        background: #ffffff;
        border: 1px solid #e2e8f0;
        border-radius: 12px;
        padding: 10px 12px;
        font-family: "IBM Plex Mono", ui-monospace, monospace;
        font-size: 0.78rem;
      }

      .formula strong {
        display: block;
        font-family: "Space Grotesk", sans-serif;
        font-size: 0.8rem;
        margin-bottom: 6px;
        color: var(--ink);
      }

      .regime {
        margin-top: 18px;
        border-radius: 14px;
        padding: 12px;
        border: 1px solid #e2e8f0;
        background: #f8fafc;
      }

      .regime.quantum {
        border-color: #c4b5fd;
        background: #f5f3ff;
        color: #4c1d95;
      }

      .regime.classical {
        border-color: #fed7aa;
        background: #fff7ed;
        color: #9a3412;
      }

      .regime h3 {
        margin: 0 0 6px;
        font-size: 0.9rem;
      }

      .chart-area {
        display: flex;
        flex-direction: column;
        gap: 16px;
      }

      .tabs {
        display: flex;
        gap: 12px;
      }

      .tab {
        background: transparent;
        border: 1px solid #e2e8f0;
        border-radius: 999px;
        padding: 8px 16px;
        font-size: 0.85rem;
        cursor: pointer;
        color: var(--muted);
        transition: all 0.2s ease;
      }

      .tab.active {
        border-color: var(--accent);
        color: var(--accent-dark);
        background: #ecfeff;
        font-weight: 600;
      }

      .chart-card {
        padding: 18px;
      }

      .chart-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 12px;
      }

      .chart-header h2 {
        margin: 0;
        font-size: 1.1rem;
      }

      .tag {
        font-size: 0.75rem;
        padding: 4px 10px;
        background: #f1f5f9;
        border-radius: 999px;
        color: #475569;
      }

      .chart {
        height: 420px;
      }

      .chart-note {
        margin-top: 10px;
        color: var(--muted);
        font-size: 0.85rem;
        line-height: 1.5;
      }

      .insights {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        gap: 14px;
      }

      .insight-card {
        background: #f8fafc;
        border: 1px solid #e2e8f0;
        border-radius: 14px;
        padding: 12px;
      }

      .insight-card h4 {
        margin: 0 0 6px;
        font-size: 0.85rem;
      }

      .insight-card p {
        margin: 0;
        font-size: 0.8rem;
        color: var(--muted);
        line-height: 1.5;
      }

      .warning {
        display: none;
        margin-top: 12px;
        background: #fff7ed;
        border: 1px solid #fed7aa;
        color: #9a3412;
        padding: 10px 12px;
        border-radius: 10px;
        font-size: 0.85rem;
      }

      @keyframes rise {
        from {
          opacity: 0;
          transform: translateY(12px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @media (max-width: 920px) {
        .layout {
          grid-template-columns: 1fr;
        }

        .chart {
          height: 340px;
        }
      }

      @media (prefers-reduced-motion: reduce) {
        * {
          animation: none !important;
          transition: none !important;
        }
      }
    </style>
  </head>
  <body>
    <div class="page">
      <header class="hero">
        <div class="eyebrow">Computational Studio</div>
        <h1>Harmonic Oscillator</h1>
        <p>
          Adjust the characteristic temperature and the plotted temperature range to see how the quantum harmonic
          oscillator transitions between quantum and classical limits.
        </p>
        <div class="meta-grid">
          <div class="meta-card">
            <span class="meta-label">Model</span>
            <span class="meta-value">1D oscillator</span>
          </div>
          <div class="meta-card">
            <span class="meta-label">Characteristic Temp</span>
            <span class="meta-value">&Theta;<sub>E</sub> = &hbar;&omega; / k<sub>B</sub></span>
          </div>
          <div class="meta-card">
            <span class="meta-label">Key Limits</span>
            <span class="meta-value">Dulong-Petit, zero-point</span>
          </div>
        </div>
      </header>

      <main class="layout">
        <aside class="panel card">
          <h2>System Parameters</h2>

          <div class="control">
            <label for="theta">Characteristic Temp (&Theta;<sub>E</sub>)</label>
            <div class="range-row">
              <input id="theta" type="range" min="50" max="1000" step="10" value="100" />
              <span class="pill" id="thetaValue">100 K</span>
            </div>
            <div class="helper">Higher &Theta;<sub>E</sub> means the oscillator stays quantum at room temperature.</div>
          </div>

          <div class="control">
            <label for="maxTemp">Temperature Range (Max T)</label>
            <div class="range-row">
              <input id="maxTemp" type="range" min="100" max="2000" step="50" value="500" />
              <span class="pill" id="maxTempValue">500 K</span>
            </div>
          </div>

          <div class="toggle-row">
            <span>Show Limit Lines</span>
            <button type="button" id="toggleLimits" class="toggle active" aria-pressed="true"></button>
          </div>

          <div class="section-title">Physics Core</div>
          <div class="formula">
            <strong>Partition variable</strong>
            x = &Theta;<sub>E</sub> / T
          </div>
          <div class="formula" style="margin-top: 10px;">
            <strong>Heat Capacity (C<sub>V</sub>)</strong>
            k<sub>B</sub> &middot; x<sup>2</sup> &middot; e<sup>x</sup> / (e<sup>x</sup> - 1)<sup>2</sup>
          </div>
          <div class="formula" style="margin-top: 10px;">
            <strong>Internal Energy (U)</strong>
            k<sub>B</sub>&Theta;<sub>E</sub> &middot; (1/2 + 1/(e<sup>x</sup> - 1))
          </div>

          <div class="regime" id="regimeCard">
            <h3 id="regimeTitle">Quantum Regime</h3>
            <div id="regimeText">At mid-graph (T ~ 250 K), thermal energy is less than the oscillator spacing.</div>
          </div>

          <div class="warning" id="plotlyWarning">
            Plotly did not load. Check network access or provide a local plotly.js file.
          </div>
        </aside>

        <section class="chart-area">
          <div class="tabs">
            <button class="tab active" data-tab="cv" type="button">Heat Capacity C<sub>V</sub>(T)</button>
            <button class="tab" data-tab="u" type="button">Internal Energy U(T)</button>
          </div>

          <div class="card chart-card">
            <div class="chart-header">
              <h2 id="chartTitle">Heat Capacity Analysis</h2>
              <span class="tag" id="chartTag">Quantum vs classical</span>
            </div>
            <div id="chart" class="chart"></div>
            <div class="chart-note" id="chartNote">
              Visualizing the freezing out of degrees of freedom at low temperatures.
            </div>
          </div>

          <div class="insights">
            <div class="insight-card">
              <h4>High-Temperature Limit (T &gt;&gt; &Theta;<sub>E</sub>)</h4>
              <p>
                As T increases, x approaches 0 and C<sub>V</sub> tends to k<sub>B</sub>. The system behaves classically.
              </p>
            </div>
            <div class="insight-card">
              <h4>Low-Temperature Limit (T &lt;&lt; &Theta;<sub>E</sub>)</h4>
              <p>
                As T approaches 0, the heat capacity collapses exponentially and the oscillator freezes into its
                ground state.
              </p>
            </div>
          </div>
        </section>
      </main>
    </div>

    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <script>
      (() => {
        const state = {
          theta: 100,
          maxTemp: 500,
          showLimits: true,
          activeTab: "cv",
        };

        const elements = {
          theta: document.getElementById("theta"),
          maxTemp: document.getElementById("maxTemp"),
          thetaValue: document.getElementById("thetaValue"),
          maxTempValue: document.getElementById("maxTempValue"),
          toggleLimits: document.getElementById("toggleLimits"),
          regimeCard: document.getElementById("regimeCard"),
          regimeTitle: document.getElementById("regimeTitle"),
          regimeText: document.getElementById("regimeText"),
          chartTitle: document.getElementById("chartTitle"),
          chartTag: document.getElementById("chartTag"),
          chartNote: document.getElementById("chartNote"),
          plotlyWarning: document.getElementById("plotlyWarning"),
        };

        const tabs = Array.from(document.querySelectorAll(".tab"));
        let chartReady = false;

        const formatNumber = (value, digits) => value.toFixed(digits);

        const computeData = () => {
          const points = 120;
          const step = state.maxTemp / points;
          const data = [];

          for (let i = 1; i <= points; i += 1) {
            const T = i * step;
            const x = state.theta / T;

            let uReduced = 0.5;
            let cvReduced = 0;

            if (x < 80) {
              const expm1 = Math.expm1(x);
              const expx = expm1 + 1;
              uReduced = 0.5 + 1 / expm1;
              cvReduced = (x * x * expx) / (expm1 * expm1);
            }

            const uHigh = T / state.theta;
            const uLow = 0.5;
            const cvHigh = 1;
            const cvLow = x * x * Math.exp(-x);

            data.push({
              T,
              u: uReduced,
              uHigh,
              uLow,
              cv: cvReduced,
              cvHigh,
              cvLow,
            });
          }

          return data;
        };

        const updateRegime = () => {
          const midTemp = Math.round(state.maxTemp / 2);
          const xMid = state.theta / Math.max(1, midTemp);
          const isQuantum = xMid > 2;

          elements.regimeCard.classList.toggle("quantum", isQuantum);
          elements.regimeCard.classList.toggle("classical", !isQuantum);
          elements.regimeTitle.textContent = isQuantum ? "Quantum Regime" : "Classical Regime";
          elements.regimeText.textContent = `At mid-graph (T ~ ${midTemp} K), thermal energy is ${
            isQuantum ? "less than" : "greater than"
          } the oscillator spacing.`;
        };

        const buildLayout = () => {
          const isCv = state.activeTab === "cv";
          return {
            title: {
              text: isCv ? "Heat Capacity C_V(T)" : "Internal Energy U(T)",
              font: { size: 15 },
              x: 0.02,
              xanchor: "left",
            },
            margin: { t: 48, r: 30, b: 50, l: 60 },
            paper_bgcolor: "rgba(0,0,0,0)",
            plot_bgcolor: "rgba(0,0,0,0)",
            font: { family: "Space Grotesk, sans-serif", color: "#0f172a" },
            xaxis: {
              title: { text: "Temperature (K)" },
              gridcolor: "#e2e8f0",
              zeroline: false,
            },
            yaxis: {
              title: { text: isCv ? "C_V / k_B" : "U / (k_B · Θ_E)" },
              gridcolor: "#e2e8f0",
              zeroline: false,
              range: isCv ? [0, 1.2] : undefined,
            },
            legend: { orientation: "h", x: 0, y: 1.18 },
          };
        };

        const buildTraces = (data) => {
          const temps = data.map((point) => point.T);
          const traces = [];

          if (state.activeTab === "cv") {
            if (state.showLimits) {
              traces.push({
                x: temps,
                y: data.map((point) => point.cvHigh),
                mode: "lines",
                name: "Classical Limit (Dulong-Petit)",
                line: { color: "#f97316", width: 2, dash: "dash" },
              });
              traces.push({
                x: temps,
                y: data.map((point) => point.cvLow),
                mode: "lines",
                name: "Low-T Approximation",
                line: { color: "#818cf8", width: 2, dash: "dot" },
              });
            }
            traces.push({
              x: temps,
              y: data.map((point) => point.cv),
              mode: "lines",
              name: "Exact Quantum Model",
              line: { color: "#0ea5a0", width: 3 },
            });
          } else {
            if (state.showLimits) {
              traces.push({
                x: temps,
                y: data.map((point) => point.uHigh),
                mode: "lines",
                name: "Classical Equipartition (kB T)",
                line: { color: "#f97316", width: 2, dash: "dash" },
              });
              traces.push({
                x: temps,
                y: data.map((point) => point.uLow),
                mode: "lines",
                name: "Zero-Point Energy",
                line: { color: "#818cf8", width: 2, dash: "dot" },
              });
            }
            traces.push({
              x: temps,
              y: data.map((point) => point.u),
              mode: "lines",
              name: "Exact Quantum Model",
              line: { color: "#0ea5a0", width: 3 },
            });
          }

          return traces;
        };

        const updateChartCopy = () => {
          if (state.activeTab === "cv") {
            elements.chartTitle.textContent = "Heat Capacity Analysis";
            elements.chartTag.textContent = "Quantum vs classical";
            elements.chartNote.textContent =
              "Visualizing the freezing out of degrees of freedom at low temperatures.";
          } else {
            elements.chartTitle.textContent = "Internal Energy Analysis";
            elements.chartTag.textContent = "Zero-point to equipartition";
            elements.chartNote.textContent =
              "Visualizing the transition from zero-point energy to the classical kB T trend.";
          }
        };

        const render = () => {
          const data = computeData();
          const layout = buildLayout();
          const traces = buildTraces(data);
          const config = { displayModeBar: false, responsive: true };

          updateRegime();
          updateChartCopy();

          if (!chartReady) {
            Plotly.newPlot("chart", traces, layout, config);
            chartReady = true;
          } else {
            Plotly.react("chart", traces, layout, config);
          }
        };

        const updateControls = () => {
          elements.thetaValue.textContent = `${state.theta} K`;
          elements.maxTempValue.textContent = `${state.maxTemp} K`;
          elements.toggleLimits.classList.toggle("active", state.showLimits);
          elements.toggleLimits.setAttribute("aria-pressed", String(state.showLimits));
        };

        const bindEvents = () => {
          elements.theta.addEventListener("input", (event) => {
            state.theta = parseFloat(event.target.value);
            updateControls();
            render();
          });

          elements.maxTemp.addEventListener("input", (event) => {
            state.maxTemp = parseFloat(event.target.value);
            updateControls();
            render();
          });

          elements.toggleLimits.addEventListener("click", () => {
            state.showLimits = !state.showLimits;
            updateControls();
            render();
          });

          tabs.forEach((tab) => {
            tab.addEventListener("click", () => {
              tabs.forEach((button) => button.classList.remove("active"));
              tab.classList.add("active");
              state.activeTab = tab.dataset.tab;
              render();
            });
          });
        };

        const init = () => {
          if (!window.Plotly) {
            elements.plotlyWarning.style.display = "block";
            return;
          }
          updateControls();
          bindEvents();
          render();
        };

        window.addEventListener("load", init);
      })();
    </script>
  </body>
</html>
